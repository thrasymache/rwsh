<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>





  
  
  
  
  
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">





  
  
  
  
  
  <title>function prototypes and option handling</title>
</head>


<body>

Currently, functions defined with .function_all_options are defined
with a function prototype, functions defined by .function are not. When
the prototypes become flexible enough to handle all cases currently in
use, .function and non-prototyped functions will go away. There will be
one or more other builtins to define functions, at least
.function_some_options which will accept flag options not declared and
store them in a separate local variable. There will be support for
multiple single-character flag options grouped behind a single dash.
There may be support for other common option-handling paradigms (e.g.
that long-options can occur after<span style="font-weight: bold;"> </span>some
positional arguments, or that arguments to flag options can be given
with an equals-sign). There will not be support for tar-style or
similar paradigms, which include rules like all characters following an
"f" in a group of short options are an argument to the -f flag. That
lack of support should only cause function wrappers for such programs
to be more restrictive in the syntax that they will accept, or at least
more restrictive in the syntax which they can add functionality to.
<h3>required arguments</h3>

...<br>





<h3>flag options</h3>



arguments in the prototype that are surrounded by <br>

...<br>

Currently all flag options must precede all positional arguments. Also
currently, a bare dash is treated as a flag, as this involves the least
special-casing, if the uses for dash all end up being as a placeholder
indicating stdin, then this may change.<br>





<h3>[--]</h3>
"--" can be used to end the search for flag options so that subsequent
arguments that begin with a dash are treated as positional arguments.
This will happen regardless of whether "[--]" is included in the
function prototype. If an inappropriate number of positional arguments
are encountered, "--" is counted amongst the optional arguments found.
The variable "--" will be set to the value "--" if it occurs in a
command line. Note that if "--" occurs more than once in the command
line that the first occurrence will be recognized as terminating the
flag arguments and any subsequent occurrences will be treated as
positional arguments. Also note that because "[--]" is implicitly in
every function prototype, "--" cannot be a required parameter.<br>




<h3>non-flag options</h3>

Arguments in the prototype that are surrounded by brackets that do not
begin with a dash are treated as optional positional arguments, and
arguments given to the function in the corresponding positions will
be&nbsp; It is most common for non-flag optional arguments to be
individual arguments and follow the required arguments, but neither of
these is necessary. non-flag optional arguments will be filled in in
the order in which they are encountered, while reserving enough
arguments to fill in the required arguments. given the following
definition:<br>

<br>

** do a function definition that won't cause variable undefined errors<br>

**** echo_vars_that_exist * do it with a for loop and .local comma ,*
add this to the startup script, and make a variant of this that prints
the name of the variable in test_main.sh<br>

<pre>.function_all_options foo [a] [b] c [d] {.echo $a , $b , $c , $d $nl}</pre>

***<br>

foo -&gt; error 0 1 0<br>

foo x -&gt; , , x ,<br>

foo x x -&gt; x , , x ,<br>

foo x x x -&gt; x , x , x ,<br>

foo x x x x -&gt; x , x , x , x<br>

foo x x x x x -&gt; error 2 1 3<br>

***<br>

Multiple non-flag optional arguments that are grouped together within a
single set of brackets are filled or not filled as a group. given the
following definition:<br>

<pre>.function_all_options foo [a b c] [d e] {.echo $a , $b , $c , $d, $e $nl}</pre>

** do a function definition that won't cause variable undefined errors<br>

<br>

foo -&gt; , , , ,<br>

foo x -&gt; error 1 0 0<br>

foo x x -&gt; , ,&nbsp;, x , x<br>

foo x x x -&gt; x , x , x , ,<br>

foo x x x x -&gt; error 1 0 3<br>

foo x x x x x -&gt;&nbsp;x , x , x , x , x<br>

foo x x x x x x -&gt; error 1 0 5<br>

<br>

note that because optional arguments that begin with a dash are
interpreted as flag options, it is not possible to name an optional
positional argument beginning with a dash.<br>


</body>
</html>
